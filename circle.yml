machine:
  java:
    version: openjdk8
  environment:
    _JAVA_OPTIONS: "-Xms512m -Xmx1024m"
    GRADLE_OPTS: '-Dorg.gradle.daemon=false -Dorg.gradle.jvmargs="-Xmx1024m -XX:+HeapDumpOnOutOfMemoryError"'

dependencies:
  pre:
    - echo y | android update sdk --no-ui --filter "tools"
    - echo y | $ANDROID_HOME/tools/bin/sdkmanager --channel=3 "build-tools;26.0.0-rc2"
    - echo y | $ANDROID_HOME/tools/bin/sdkmanager "extras;google;m2repository"
  override:
    - ./gradlew dependencies --console=plain

test:
  override:
    - ./gradlew build -PdisablePreDex --console=plain
  post:
    - cp -r app/build/reports/* $CIRCLE_TEST_REPORTS
    - cp -r app/build/outputs/apk/* $CIRCLE_ARTIFACTS
